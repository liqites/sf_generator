<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>SF generator by liqites</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <link rel="stylesheet" href="stylesheets/semantic.css">
    <script src="http://lib.sinaapp.com/js/jquery/1.10.2/jquery-1.10.2.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <script src="javascripts/semantic.min.js"></script>
    <script src="javascripts/papaparse.min.js"></script>
    <script type="text/javascript" src="http://oss.sheetjs.com/js-xlsx/xlsx.core.min.js"></script>
    <script src="javascripts/blob.js"></script>
    <script src="javascripts/filesaver.js"></script>
    <script src="javascripts/converter.js"></script>
    
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>
    <div class="ui top fixed inverted menu">
    </div>
    <div class="ui container" style="margin-top: 50px">  
      <h2 class="ui header">
        <img src="images/plugin.png">
        <div class="content" >
          小工具
          <div class="sub header">订单转化</div>
        </div>
      </h2>
      <div class="ui divider"></div>
      <div class="ui buttons">
        <a class="ui primary button" id="select-file-btn">选择</a>
        <input type="file" style="display:none" id="select-file"></input>
        <a class="ui green button" id="transfer-sf">转化</a>
      </div>
      <div class="ui buttons">
        <a href="templates/%E6%9C%89%E8%B5%9E%E6%A8%A1%E7%89%88.csv" class="ui button">下载CSV模版</a>
        <a href="templates/%E6%9C%89%E8%B5%9E%E6%A8%A1%E7%89%88.xls" class="ui button">下载Excel模版</a>
      </div>
    </div>
  </body>
  
  <script type="text/javascript">
    $(document).ready(function(){
      $("#select-file-btn").on('click', function(e) {
        $("#select-file").click();
      });

      $("#transfer-sf").on('click', function(e) {
        file = $("#select-file")[0].files[0];
        $(this).addClass('loading');
        Papa.parse(file, {
          complete: function(obj) {
            Converter.to_sf(obj.data)
          },
          error: function(error) {
            console.log(error);
            $(this).removeClass('loading');
          }
        });
        $(this).removeClass('loading');
      });

      $("#select-file").on("change", function(e){
        // file = this.files[0];
        // Papa.parse(file, {
        //   complete: function(obj) {
        //     // console.log(obj);
        //     Converter.to_sf(obj.data)
        //   },
        //   error: function(error) {
        //     console.log(error);
        //   }
        // });
      })
    })
  </script>
</html>